# Immich Helm Chart Values - Only Essential Overrides
# Default chart version: v1.119.0, server+ML enabled, postgresql+redis disabled

# Update to latest version
image:
  tag: "v1.139.2"

# External database configuration (CloudNativePG)
env:
  DB_HOSTNAME: "immich-postgres-rw.immich.svc.cluster.local"
  DB_DATABASE_NAME: "immich"
  DB_USERNAME: "immich"
  DB_PASSWORD:
    valueFrom:
      secretKeyRef:
        name: immich-postgres-secret
        key: password
  DB_VECTOR_EXTENSION: "pgvector"
  REDIS_HOSTNAME: "immich-redis-master.immich.svc.cluster.local"

# Homelab resource limits
server:
  resources:
    requests:
      cpu: 200m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi

machineLearning:
  persistence:
    cache:
      enabled: true
      existingClaim: "immich-ml-cache"
  resources:
    requests:
      cpu: 500m
      memory: 1Gi
    limits:
      cpu: 2000m
      memory: 4Gi

# Library storage
immich:
  persistence:
    library:
      enabled: true
      existingClaim: "immich-library"

# Enable Redis subchart with minimal config
redis:
  enabled: true
  auth:
    enabled: false
  master:
    persistence:
      enabled: true
      size: 1Gi
      storageClass: local-path
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 200m
        memory: 256Mi

# Explicitly disable unused components
postgresql:
  enabled: false