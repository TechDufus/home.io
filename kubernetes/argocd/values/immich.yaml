# Immich - Homelab Configuration (chart 0.10.3)

controllers:
  main:
    containers:
      main:
        env:
          DB_HOSTNAME: "immich-postgres.immich.svc.cluster.local"
          DB_PORT: "5432"
          DB_DATABASE_NAME: "immich"
          DB_USERNAME: "immich"
          DB_PASSWORD:
            valueFrom:
              secretKeyRef:
                name: immich-postgres-secret
                key: DB_PASSWORD
          IMMICH_MACHINE_LEARNING_URL: '{{ printf "http://%s-machine-learning:3003" .Release.Name }}'

immich:
  persistence:
    library:
      existingClaim: immich-library

valkey:
  enabled: true
  persistence:
    data:
      enabled: true
      type: persistentVolumeClaim
      size: 1Gi
      storageClass: longhorn

server:
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      memory: 2Gi

machine-learning:
  persistence:
    cache:
      enabled: true
      type: persistentVolumeClaim
      existingClaim: immich-ml-cache
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      memory: 2Gi
